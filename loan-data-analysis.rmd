---
title: "Analyzing Loan Data - Prosper Funding LLC"
author: "Aritra Chattaraj"
date: "January 26, 2019"
output: html_document
---
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}

# The other parameters for "message" and "warning" should also be set to FALSE
# for other code chunks once you have verified that each plot comes out as you
# want it to. This will clean up the flow of your report.

library(tidyverse)
library(ggplot2)

```

## Introduction - Prosper
> Prosper Marketplace, Inc. is a San Francisco, California-based company in the peer-to-peer lending industry. Prosper Funding LLC, one of its subsidiaries, operates Prosper.com, a website where individuals can either invest in personal loans or request to borrow money.

> Prosper Marketplace is America's first peer-to-peer lending marketplace, with over $7 billion in funded loans. Borrowers request personal loans on Prosper and investors (individual or institutional) can fund anywhere from $2,000 to $35,000 per loan request. Investors can consider borrowers' credit scores, ratings, and histories and the category of the loan. Prosper handles the servicing of the loan and collects and distributes borrower payments and interest back to the loan investors.

> Prosper verifies borrowers' identities and select personal data before funding loans and manages all stages of loan servicing. Prosper's unsecured personal loans are fully amortized over a period of three or five years, with no pre-payment penalties. Prosper generates revenue by collecting a one-time fee on funded loans from borrowers and assessing an annual loan servicing fee to investors.

> Prosper has provided an increasing amount of information about prospective borrowers over time, while also making various changes to its credit policy. Prior to its 2008 'quiet period' and 2009 SEC registration, the company provided "Credit Grades" and other credit information about its prospective lenders. Following the SEC registration, the company created a new model that determined "Prosper Ratings" instead. Additionally, new prospective borrowers were required to have an FICO 8 credit score of at least 640, while returning borrowers only need a score of 600 to request a loan.

## Project Brief
> This project analyzes about 114,000 observations and 12 of the 81 variables in this data set. The data set contains information of about 114,000 individuals (anonymized, of course) across 81 parameters. 

> There are three major sections in this project, each providing a piece for the final assessment. These sections are - Univariate Analysis, Bivariate Analysis and Multivariate Analysis. At the end, the final summary explains the results of our analyses.

## Variables of Interest
> The 12 variables of interest chosen out of the 81, for the purpose of this project, are: **LoanStatus, ProsperScore, BorrowerAPR, BorrowerRate, EmploymentStatus, Occupation, EmploymentStatusDuration, IsBorrowerHomeowner, StatedMonthlyIncome, MonthlyLoanPayment, DebtToIncomeRatio, LoanOriginalAmount.** 


```{r}
# Load the Data

data <- read_csv("C:/Users/Endurance-III/Desktop/prosper-loan-analysis/prosperLoanData.csv")

# View the data
head(data, n = 10)

```

## Univariate Plots Section

> This section explores univariate characteristics in our data through multiple univariate plots.

> The dataset is first subsetted to include only the 12 variables of importance prior to any further analysis/plots.

### Subsetting the data

```{r echo=FALSE, Univariate_Plots}

# Subsetting original df into new variable sub_data

sub_data <- data[c('LoanStatus', 'ProsperScore', 'BorrowerAPR', 'BorrowerRate', 'EmploymentStatus', 'Occupation', 'EmploymentStatusDuration', 'IsBorrowerHomeowner', 'StatedMonthlyIncome', 'MonthlyLoanPayment', 'DebtToIncomeRatio', 'LoanOriginalAmount')]

# Viewing subsetted data

head(sub_data, n = 20)

```

> The data has been successfully subsetted and contains all the observations and only the seleted 12 variables.

#### Summary of Data
> Prior to some plots, let us check out the characteristics of the chosen variables in our data subset.

```{r echo=FALSE}

summary(sub_data)

```

> The summary reveals a number of interesting points about our data - there are 8 numerical variables (ProsperScore, BorrowerAPR, BorrowerRate, EmploymentStatusDuration, StatedMonthlyIncome, MonthlyLoanPayment, DebtToIncomeRatio, LoanOriginalAmount); there are 3 categorical variables (LoanStatus, Occupation, EmploymentStatus); there is 1 logical (dichotomous i.e. Y/N or True/False in this case) variable (IsBorrowerHomeowner).

> There are a number of missing or NaN variables with the highest number being 29084 (ProsperScore) and lowest non-zero being 25 (BorrowerAPR). This is something to keep in mind to decide whether we want to omit the observations or impute them and what best method for imputation should be chosen at the time of modeling.

> A number of other observations in the summary is, perhaps, better explained through the following plots.

### Plots - Univariate

#### Univariate Plot 1 - ProsperScore

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$ProsperScore)) + 
  geom_histogram(col = "blue", bins = 50, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - ProsperScore", x = "Scores", y = "Frequency") 

```

> The histogram reveals a trend in the ProsperScore where the mean is centered around 4-8 on the scale. Most of the observations or individuals have a Prosper Score in the brackets of 4, 6 or 8 and the data is normally distributed with a slight right-skew and leptokurtic tendency.

#### Univariate Plot 2 - BorrowerAPR

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$BorrowerAPR)) + 
  geom_histogram(col = "blue", bins = 50, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - BorrowerAPR", x = "Rates", y = "Frequency") 

```

> The BorrowerAPR reveals an almost normally distributed characteristic with an unusually large number of observations between 0.3 - 0.4 (almost like a bimodal distribution). The data is definitely right skewed and leptokurtic.

#### Univariate Plot 3 - BorrowerRate

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$BorrowerRate)) + 
  geom_histogram(col = "blue", bins = 50, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - BorrowerRate", x = "Rates", y = "Frequency") 

```

> BorrowerRate exhibits very similar characteristics as our BorrowerAPR.

#### Univariate Plot 4 - EmploymentStatusDuration

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$EmploymentStatusDuration)) + 
  geom_histogram(col = "blue", bins = 50, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - EmploymentStatusDuration", x = "Duration", y = "Frequency") 

```

> Employment Status Duration represents a power-law distribution of the data which is heavily right-skewed. This implies that a large number of Prosper customers have an employment duration of 2-3 years whereas there are outliers such as 44 years and more.

#### Univariate Plot 5 - StatedMonthlyIncome (Limited to $50,000 per month)

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$StatedMonthlyIncome)) + 
  geom_histogram(col = "blue", bins = 50, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - StatedMonthlyIncome", x = "Monthly Income", y = "Frequency") +
  xlim(0, 50000)

```

> Shows a power-law distribution with a heavy right-skew. Majority of the income earners make about $4,000 - $6,000 a month.

#### Univariate Plot 6 - MonthlyLoanPayment 

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$MonthlyLoanPayment)) + 
  geom_histogram(col = "blue", bins = 40, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - MonthlyLoanPayment", x = "Monthly Payment", y = "Frequency") 

```

> Shows a power-law distribution with a heavy right-skew, similar to our last plot. Majority of the monthly payments are in the range $150 - $250. 

#### Univariate Plot 7 - DebtToIncomeRatio 

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$DebtToIncomeRatio)) + 
  geom_histogram(col = "blue", bins = 30, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - DebtToIncomeRatio", x = "DTI Ratio", y = "Frequency") 

```

> Follows a power-law distribution, with right-skew, similar to some of our previous plots. The Debt to Income ratio, for a majority of people, is (fortunately) less than 1 and around 0.5. There area few outliers at DTI of 2.5.

#### Univariate Plot 8 - LoanOriginalAmount

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$LoanOriginalAmount)) + 
  geom_histogram(col = "blue", bins = 50, alpha = 0.8, aes(fill = ..count..)) +   
  labs(title = "Histogram - LoanOriginalAmount", x = "Loan Amount", y = "Frequency") 

```

> The distribution is right-skewed with a majority of the amount falling in the buckets of ~$50,000, ~$100,000, ~$150,000. Interesting to note here also is that the majority of the loans taken, that are over ~$100,000, are in increments of ~$50,000, such as $150,000 or $200,000 or $250,000. 

#### Univariate Plot 9 - LoanStatus

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$LoanStatus)) + 
  geom_bar(col = "blue", alpha = 0.8, aes(fill = ..count..)) +
  labs(title = "Bar Chart - LoanStatus", x = "Loan Status", y = "Frequency") +
  coord_flip()

```

> This is the first of the categorical variables of interest to be visualized - what we can see right off the bat is the frequency of people whose loan status is 'Current' as they form the majority of the observations in our data. We can ascertain that most of the people are either currently indebted ('Current') or have paid off their loan ('Completed') or have been 'Chargedoff' or they have defaulted on their loan ('Defaulted'). These 4 are our primary labels of interest while we're investigating 'LoanStatus' variable.

#### Univariate Plot 10 - Occupation

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$Occupation)) + 
  geom_bar(col = "blue", alpha = 0.8, aes(fill = ..count..)) +
  labs(title = "Bar Chart - Occupation", x = "Occupations", y = "Frequency") +
  coord_flip()

```

> Interestingly enough a vast majority of the observations identify themselves with the "Others" occupation whereas the second-highest majority identity with "Professional." 

#### Univariate Plot 11 - EmploymentStatus

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$EmploymentStatus)) + 
  geom_bar(col = "blue", alpha = 0.8, aes(fill = ..count..)) +
  labs(title = "Bar Chart - EmploymentStatus", x = "EmploymentStatus", y = "Frequency") +
  coord_flip()

```

> Most of the observations are full-time employees. Very few retirees and part-time employees. A significant number of people are self-employed. Few people are not employed, whereas there seems to be a redundancy in the lables with both 'NA' and 'Not available' featuring in the data. Having said that, there might be a specific business reason for why they have been categorized differently. 

#### Univariate Plot 12 - IsBorrowerHomeowner

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$IsBorrowerHomeowner)) + 
  geom_bar(col = "blue", alpha = 0.8, aes(fill = ..count..)) +
  labs(title = "Bar Chart - EmploymentStatus", x = "EmploymentStatus", y = "Frequency")

```

> The number of homeowners versus the number of non-homeowners are almost the same wherein the homeowners are slightly more. 

## Univariate Analysis

### What is the structure of your dataset?

> This dataset is of the dimension 113937x81 out of the which the focus has been on a subset of dimension 113937x12. The data was also in a tidy format at the outset, therefore, there was no need for formatting it any further prior to analyses.

### What is/are the main feature(s) of interest in your dataset?

> I have picked 12 variables to explore in this project. The two variables that are of my primary interest are LoanStatus and IsBorrowerHomeowner.

### What other features in the dataset do you think will help support your \
investigation into your feature(s) of interest?

> I think the other 10 features besides the two main features of interest can help with the investigation, to name a few: ProsperScore, LoanOriginalAmount, Occupation.

### Did you create any new variables from existing variables in the dataset?

> No, I did not perform any kind of feature engineering for the purpose of this exploratory project. That kind of requirement just never popped up so far.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

> The data was already in a tidy format. As far as distributions are concerned, I've made a comment on the characteristics of the distributions which I arrived to via histograms after each plot. For the categorical variables, I had to flip the x and y axes to ensure better readability of the labels and their corresponding frequencies. 

> Some of the variables were almost normally distributed, some followed a power-law distribution - by and large, I've made an effort to note that down alongside the aforementioned plots.

## Bivariate Plots Section

#### Summary

> At this juncture, to further examine our variables of interest, we proceed with some bivariate plots. These plots will help us figure out the relationship between variables that are coupled together.

### Plots - Bivariate

#### Bivariate Plot 1 - ProsperScore and BorrowerRate

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$ProsperScore, sub_data$BorrowerRate)) + 
  geom_jitter(col = 'darkgreen') +
  labs(x = "ProsperScore", y = "BorrowerRate") 
  
```

#### Bivariate Plot 2 - ProsperScore and BorrowerAPR 

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$ProsperScore, sub_data$BorrowerAPR)) + 
  geom_jitter(col = 'darkgreen') +
  labs(x = "ProsperScore", y = "BorrowerAPR") 
  
```

#### Bivariate Plot 3 - MonthlyLoanPayment and Occupation

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$MonthlyLoanPayment, sub_data$Occupation)) + 
  geom_point(col = 'darkgreen') +
  labs(x = "MonthlyLoanPayment", y = "Occupations") 
  
```

#### Bivariate Plot 4 - ProsperScore and LoanStatus

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$ProsperScore, sub_data$LoanStatus)) + 
  geom_jitter(col = "darkgreen") +
  labs(x = "ProsperScore", y = "LoanStatus") 
  
```

#### Bivariate Plot 5 - ProsperScore and IsBorrowerHomeowner

```{r echo=FALSE}

ggplot(data = sub_data, aes(sub_data$IsBorrowerHomeowner, sub_data$ProsperScore)) + 
  geom_jitter(col = "darkgreen") +
  labs(x = "ProsperScore", y = "IsBorrowerHomeowner") 
  
```

## Bivariate Analysis

> **Tip**: As before, summarize what you found in your bivariate explorations
here. Use the questions below to guide your discussion.

### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

### Did you observe any interesting relationships between the other features \
(not the main feature(s) of interest)?

### What was the strongest relationship you found?


# Multivariate Plots Section

> **Tip**: Now it's time to put everything together. Based on what you found in
the bivariate plots section, create a few multivariate plots to investigate
more complex interactions between variables. Make sure that the plots that you
create here are justified by the plots you explored in the previous section. If
you plan on creating any mathematical models, this is the section where you
will do that.

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the \
investigation. Were there features that strengthened each other in terms of \
looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the \
strengths and limitations of your model.

------

# Final Plots and Summary

> **Tip**: You've done a lot of exploration and have built up an understanding
of the structure of and relationships between the variables in your dataset.
Here, you will select three plots from all of your previous exploration to
present here as a summary of some of your most interesting findings. Make sure
that you have refined your selected plots for good titling, axis labels (with
units), and good aesthetic choices (e.g. color, transparency). After each plot,
make sure you justify why you chose each plot by describing what it shows.

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection

> **Tip**: Here's the final step! Reflect on the exploration you performed and
the insights you found. What were some of the struggles that you went through?
What went well? What was surprising? Make sure you include an insight into
future work that could be done with the dataset.

> **Tip**: Don't forget to remove this, and the other **Tip** sections before
saving your final work and knitting the final report!